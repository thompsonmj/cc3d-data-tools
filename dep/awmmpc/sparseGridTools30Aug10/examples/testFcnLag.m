function [f1 f2 f3] = testFcnLag(p)

fun = @(x) (exp(x(:,1) + x(:,2).*x(:,4)) + x(:,1).*x(:,2).*x(:,3).*x(:,4) + x(:,4).*x(:,1).^2 + 10.*x(:,2).*x(:,3) + (x(:,3) + x(:,4)).^2 + 50.*(x(:,1)).*(x(:,2)/2).^5);
% fun = @(x) (x(:, 1) + x(:,2).*x(:,4) + x(:,1).*x(:,2).*x(:,3).*x(:,4) + x(:,4).*x(:,1).^2 + 10.*x(:,2).*x(:,3) + (x(:,3) + x(:,4)).^2);
% fun = @(x) (x(:,1).*x(:,2).*x(:,3).*x(:,4));
f1 = fun(p);
f2 = f1.^2;

deg1 = 4;
coord1 = 1;

deg2 = 2;
coord2 = 2;

L1  = legendreAll(4, p(:, coord1));
L2  = legendreAll(4, p(:, coord2));
% v = L1(:,2).*L2(:,3);

vd1c1 = L1(:, deg1+1);
vd2c2 = L2(:, deg2+1);
f3 =  vd1c1 .* vd2c2 + p(:, 3).^2.*p(:, 4).^2 + p(:, 2).^2.*p(:, 4);

end